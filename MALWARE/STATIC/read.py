
# Python program to read 
# file word by word
import sys
import os  
import pandas as pd
from csv import writer

# opening the text file
def process(f):
    array = []
    vertices = {}
    done=0
    words=[]

    n=0;
    with open(f,'r') as file1:
    # reading each line    
        for line in file1:
            if "->" in line:done =1
        # reading each word        
            for word in line.split():
                if(word.startswith("\"0")):
                    if(word not in words):vertices[word] = n;words.append(word);array.append(n);n=n+1;
                    else:array.append(vertices[word]);
                if(word.startswith("mov")|word.startswith("sub")|word.startswith("call")|word.startswith("add")|word.startswith("jmp")|word.startswith("push")|word.startswith("xor")|word.startswith("je")|word.startswith("lock")|word.startswith("cmp")|word.startswith("lea")|word.startswith("jz")|word.startswith("test")|word.startswith("jmp")|word.startswith("add")|word.startswith("jnz")|word.startswith("pop")|word.startswith("xor")|word.startswith("retn")|word.startswith("movzx")|word.startswith("and")|word.startswith("or")|word.startswith("inc")|word.startswith("stosq")|word.startswith("syscall")|word.startswith("setno")|word.startswith("cvtsd2si")|word.startswith("movmskpd")|word.startswith("prefetcht1")|word.startswith("fprem")|word.startswith("cmpsq")|word.startswith("lodsq")|word.startswith("scasq")|word.startswith("cvtss2si")|word.startswith("fnsave")|word.startswith("orpd")|word.startswith("fxsave")|word.startswith("movmskps")):array.append(word);
                if(word.startswith("->")):array.append(word);
    return array

def read_files(root):
    files = []
    for dir_name, sub_dir_list, file_list in os.walk(root):
        for file_name in file_list:
            file_path = os.path.join(dir_name, file_name)
            if 'txt' in file_path:
                files.append(file_path)

    return files

files = read_files(sys.argv[1]);
print(len(files))
for f in files:
    array = process(f);
    with open(sys.argv[2], 'a') as f_object:
        writer_object = writer(f_object)
        writer_object.writerow(array)
        f_object.close()
   
            # displaying the words           
            #print(word) 
